\begin{dfn}
    Let $K$ be a functor from commutative rings to groups.
    Recall from~\cite{LSV2} that $K$ is called \textit{locally acyclic (resp., locally acyclic for domains)} if for every commutative local ring (resp., domain) $A$ the following diagram whose arrows are induced by natural embeddings is a pullback square:
    \begin{equation}\label{eq:P1-square} \begin{tikzcd} K(A) \ar[r] \ar[d] & K(A[X]) \arrow{d} \\ K(A[X\inv]) \ar{r} & K(A[X, X\inv]). \end{tikzcd} \end{equation}
\end{dfn}

Now we can formulate the main result of this section.
\begin{thm}[Horrocks theorem for $\K_2$]\label{thm:horrocks-k2}
Let $\Phi$ be a root system of type $\rA_{\geq 4}$, $\rD_{\geq 5}$, $\rE_6$ or $\rE_7$.
Then the functor $\K_{2}(\Phi, -)$ is locally acyclic for domains.
\end{thm}
Horrocks theorem for $\K_2$ has been previously known in the linear and even orthogonal case $\Phi=\rA_{\geq 4},\rD_{\geq 7}$, see~\cite[Theorem~1]{LS20},\cite[Proposition~4.3]{Tu83}.
Notice also that the orthogonal version of Horrocks theorem for $\K_2$ was proved under the additional assumption that $2 \in A^\times$.
Our theorem generalizes both these results and also improves them in the following respects:
\begin{itemize}
    \item It applies to exceptional root systems ($\Phi = \rE_6, \rE_7$);
    \item In the orthogonal case it makes no assumptions on the invertibility of $2$ and also requires a weaker assumption on the rank of $\Phi$.
\end{itemize}

Since our proof of Horrocks theorem is rather long and technical we at first will try to illustrate its strategy
 by comparison with the existing proofs of Horrocks theorem for $\K_1$ (cf.~\cite{Abe83, St-poly},~\cite[\S~VI.6]{Lam10}).

Let $A$ be a local ring with maximal ideal $M$ and residue field $k$.
Recall from~\cite[\S~4]{Su77} or~\cite[\S~VI.6]{Lam10} that for $r \geq 3$ the elementary linear group $\E_r(A[X, X\inv])$ admits the following decomposition:
\begin{equation}\label{eq:triple-decomposition}
\E_r(A[X^{\pm 1}]) = \E_r(A[X]) \cdot B(A[X^{\pm 1}]) \cdot \E_r(A[X^{\pm 1}], M[X^{\pm 1}]).
\end{equation}
Here $\E_r(-)$ denotes the same object as $\Esc(\rA_{r - 1}, -)$ before.
Recall that the relative elementary subgroup $\E_r(R, I)$ is defined as the kernel of canonical reduction homomorphism $\E_r(R) \to \E_r(R/I).$
Recall also that $B(R)$ denotes the Borel subgroup (i.\,e. the semidirect product of the unipotent radical $\UU(\Phi^+, R)$ and the group of diagonal matrices).

Decomposition~\eqref{eq:triple-decomposition} is a key tool in the study of the {$\K_1$-analogue of Serre's problem}.
We want to devise some analogue of it which would be suitable for study of Steinberg groups.

Now let us list the key steps of the proof:
\begin{itemize}
    \item Step 1. We use the formalism of triples discussed in~\cref{subsec:triples} to reduce the problem of
    \item Step 2.
\end{itemize}

\subsection{Initial reductions} \label{subsec:structure-theorem-overview}
Significant progress towards proving~\cref{thm:horrocks-k2} has already been achieved in~\cite{LS20}.
In this subsection we reduce~\cref{thm:horrocks-k2} to a specific technical statement which will be addressed in the following sections.

The following lemma provides the initial key reduction in the proof of~\cref{thm:horrocks-k2}.
\begin{lemma} \label{lem:first-reduction}
Let $A$ be a local ring with maximal ideal $M$ and residue field $k$.
Let $\Phi$ be as in the statement of~\cref{thm:horrocks-k2}.
Suppose that the canonical homomorphism
\begin{equation} \label{eq:c-surj} C(\Phi, A[X], M[X]) \to C(\Phi, A[X, X\inv], M[X, X\inv]) \end{equation}
is surjective.
Then the square~\eqref{eq:P1-square} is pullback.
\end{lemma}
\begin{proof}
    Denote by $R$ the Laurent polynomial ring $A[X, X\inv]$ and by $B$ the subring $A[X\inv] + M[X] \subseteq R$.
    We also set $I \subseteq M[X, X\inv]$, which is clearly an ideal of both $B$ and $R$.
    Consider the following diagram with rows obtained from~\eqref{eq:relative-Steinberg}:
    \[\begin{tikzcd}
          C(\Phi, B, I) \arrow{r} \arrow[d, swap, twoheadrightarrow] & \St(\Phi, B, I) \arrow{r}{\mu_B} \arrow{d} & \St(\Phi, B) \arrow{r} \arrow{d} & \St(\Phi, k[X^{-1}]) \arrow[hookrightarrow]{d} \\
          C(\Phi, R, I) \arrow{r} & \St(\Phi, R, I) \arrow{r}{\mu_R} \arrow[ur, "t", dashrightarrow] & \St(\Phi, R) \arrow{r} & \St(\Phi, k[X, X^{-1}]).
    \end{tikzcd}\]
    The lifting $t$ is obtained from~\cite[Lemma~3.3]{LS20}.
    The right-hand side vertical arrow is injective by~\cite[Lemma~2.2]{LS20}.
    The left-hand side vertical arrow is surjective since the composite arrow
    $\xymatrix{ C(\Phi, A[X], M[X]) \ar[r] & C(\Phi, B, I) \ar[r] & C(\Phi, R, I) }$
    is surjective by lemma's assumption.
    It remains to repeat the diagram chasing argument of~\cite[Theorem~1]{LS20} to conclude that the homomorphism $\St(\Phi, B) \to \St(\Phi, A[X, X\inv])$ is injective.
    The assertion of the lemma will then follow from~\cite[Theorem~3]{LS20}.
\end{proof}
The proof of Horrocks theorem is, thus, reduced to showing that~\eqref{eq:c-surj} is surjective for every local domain $(A, M)$.
In order to formulate the second reduction we need to recollect some notation pertaining to subgroups of $\St(\Phi, R)$.

For a \textit{special} subset of $\Phi$ (i.\,e. a subset $S \subseteq \Phi$ such that $S \cap -S = \varnothing$)
we denote by $\UU(S, R)$ the subgroup of $\St(\Phi, R)$ generated by $x_\alpha(a)$, where $a \in R$, $\alpha \in S$.
Similarly, for an ideal $I \trianglelefteq R$ we denote by $\UU(S, I)$ the subgroup of $\St(\Phi, R, I)$ generated by $x_\alpha((0;m))C$, $m \in I$, $\alpha \in S$.
Notice that the restriction of $\pi$ to $\UU(S, R)$ is a monomorphism, so $\UU(S, R)$ is isomorphic to a unipotent subgroup of $\Gsc(\Phi, R)$.

Not let us introduce shorter notation for Steinberg groups and their subgroups that will be relevant for the proof of Horrocks theorem.
\begin{align*}
    G     =& \St(\Phi, A[X, X^{-1}]),\\
    G^+   =& \St(\Phi, A[X]),\\
    B     =& \UU(\Phi^+, A[X, X\inv]) \rtimes \StH(\Phi, A[X, X\inv]) \leq G,\\
    G_M   =& \St(\Phi, A[X, X^{-1}], M[X, X^{-1}]),\\
    U^+   =& \UU(\Phi^+, A[X]),\\
    G^+_M =& \St(\Phi, A[X], M[X]),\\
    B_M   =& \UU(\Phi^+, M[X, X^{-1}]) \times \{X, 1+M\} \leq G_M,\\
    U^+_M =& \UU(\Phi^+, M[X]).
\end{align*}
In the definition of $B_M$ we denote by $\{X, 1+M\}$ the image of the homomorphism $\{X, -\}_{r}$ from~\eqref{eq:relative-symbol}.

The above groups can be organized into the following commutative diagram:
\begin{equation} \label{eq:cube-Steinberg} \xymatrix{
    U^+_M \ar@{^{(}->}[rr] \ar@{^{(}->}[dd] \ar@{^{(}->}[rd] &                        & B_M \ar[dd]^(.3){g_B^M} \ar@{^{(}->}[rd]^{g^B_M} &           \\
    & G^+_M \ar[rr]^(.3){g^+_M} \ar^(.3){g^M_+}[dd] &                   & G_M \ar[dd]_{h_M} \\
    U^+ \ar@{^{(}->}[rr]^(.3){g_B^+} \ar@{^{(}->}[rd]_{g_+^B}          &                        & B \ar@{^{(}->}[rd]_{h_B}       &           \\
    & G^+ \ar[rr]_{h_+}              &                   & G.}\end{equation}
Here $g^M_+$ and $h_M$ are just renamed homomorphisms $\mu$ from~\eqref{eq:relative-Steinberg}.
Homomorphism $g^M_B$ is also induced by $\mu$.
Maps $g_M^+$ and $h^+$ are induced by the ring embedding $A[X] \to A[X, X\inv]$.
The other homomorphisms on the diagram are all obvious subgroup embeddings.

Set $V = G^+\times B \times G_M$, $W = U^+\times G^+_M \times B_M$.
Both homomorphisms $g_+^M$ and $h_M$ are crossed modules by~\cref{lem:rel-Steinberg-crossed-module}.
The fact that $(g^+_M, h_+)$ is a map of precrossed modules is obvious.
Thus, we find ourselves in the situation of~\cref{subsec:triples}.

The following lemma provides the second key reduction in the proof of Horrocks theorem.
\begin{lemma}
    Suppose that $A$ is a domain.
    Suppose that $V/\sim_W$ admits an action of $G$ with the only property that
      for $g \in G_M$ one has \[ h_M(g) \cdot [1, 1, 1] = [1, 1, g]. \]
    Then the canonical homomorphism~\eqref{eq:c-surj} is surjective.
\end{lemma}
\begin{proof}
  Since $A$ is a domain, $g^M_B$ is injective by~\cref{lem:symbols}.
    Thus, the back face of~\eqref{eq:cube-Steinberg} is pull-back.
  Notice that for any $g \in C(\Phi, A[X, X\inv], M[X, X\inv]) \subseteq G_M$ one has
    \[ [1, 1, 1] = h_M(g) \cdot [1, 1, 1] = [1, 1, g].\]
  It is clear now that $g$ lies in the image of $C(\Phi, A[X], M[X])$ under $g^+_M$ by~\cref{lem:one-one-z}.
\end{proof}

\begin{rem}
    Notice that in the linear case the symbol homomorphism $A^\times \to \K_2(A[X, X\inv])$, $a \mapsto \{a, X\}$ admits section
     for a general commutative ring $A$, cf~\cite{Wa71}.
    Thus, the linear case ($\Phi = \rA_\ell$) the assertion of the lemma remains true without the assumption that $A$ is a domain, see~\cite[Lemma~3.1g]{Tu83}.
\end{rem}

\textbf{TODO}: Use Curtis--Tits to reduce everything to a short list of relations that need to be verified

\tikzset{
    root/.style={circle, draw, minimum size=0.2cm, inner sep=0},
    zeroroot/.style={circle, draw, minimum size=0.2cm, inner sep=0, fill=yellow},
    highlighted/.style={circle, draw, minimum size=0.2cm, inner sep=0, fill=green},
    levi/.style={draw, dashed, rounded corners},
    dottededge/.style={dotted},
    labeled/.style={below}
}

\begin{longtable}{ c c c }
    \scalebox{0.69}{\begin{tikzpicture}
          \node[root, highlighted, label=$1$] (d1) at (0,0.5) {};
          \node[root, label=$2$] (d2) at (1,0) {};
          \node[root, label=$3$] (d3) at (2,0) {};
          \node at (3,0) {\ldots};
          \node[root, label={[xshift=-0.5cm, yshift=-0.6cm]$\ell-2$}] (dl2) at (4,0) {};
          \node[root, label={[xshift=-0.6cm, yshift=-0.35cm]$\ell-1$}] (dl1) at (5,0.5) {};
          \node[root, label={[xshift=-0.5cm, yshift=-0.3cm]$\ell$}] (dl) at (5,-0.5) {};
          \node[root, zeroroot, label=below:{$0$}] (d0) at (0,-0.5) {};

          \draw (d1) -- (d2) -- (d3) -- (2.5,0);
          \draw (3.5,0) -- (dl2) -- (dl1);
          \draw (dl2) -- (dl);
          \draw[dottededge] (d2) -- (d0);

          \begin{scope}
              \node[levi, fit=(d2) (d3) (dl) (dl1) (dl2), label=above:{$\Delta$}] {};
          \end{scope}
    \end{tikzpicture}}
    &
    \scalebox{0.69}{\begin{tikzpicture}
        \begin{scope}
            \node[root, highlighted, label=$1$] (e1) at (0,0) {};
            \node[root, label=$3$] (e3) at (1,0) {};
            \node[root, label={[xshift=-0.3cm]$4$}] (e4) at (2,0) {};
            \node[root, label=$5$] (e5) at (3,0) {};
            \node[root, label=$6$] (e6) at (4,0) {};
            \node[root, label={[xshift=-0.3cm,yshift=-0.3cm]$2$}] (e2) at (2,1) {};
            \node[root, zeroroot, label=left:$0$] (e0) at (2,2) {};
            \draw (e1) -- (e3) -- (e4) -- (e5) -- (e6);
            \draw (e2) -- (e4);
            \draw[dottededge] (e2) -- (e0);

            \begin{scope}
                \node[levi, fit= (e2) (e3) (e4) (e5) (e6), label=above:{$\Delta$}] {};
            \end{scope}
        \end{scope}
    \end{tikzpicture}}
    &
    \scalebox{0.69}{\begin{tikzpicture}
        \begin{scope}
            \node[root, zeroroot, label={0}] (e0) at (0,0) {};
            \node[root, label={$1$}] (e1) at (1,0) {};
            \node[root, label={$3$}] (e3) at (2,0) {};
            \node[root, label={[xshift=-0.3cm]$4$}] (e4) at (3,0) {};
            \node[root, label={$5$}] (e5) at (4,0) {};
            \node[root, label={$6$}] (e6) at (5,0) {};
            \node[root, label={[xshift=-0.3cm,yshift=-0.3cm]$2$}] (e2) at (3,1) {};
            \node[root, highlighted, label={$7$}] (e7) at (6,0) {};

            \draw (e1) -- (e3) -- (e4) -- (e5) -- (e6) -- (e7);
            \draw (e2) -- (e4);
            \draw[dottededge] (e0) -- (e1);

            \begin{scope}
                \node[levi, fit=(e1) (e2) (e3) (e4) (e5) (e6), label=above:{$\Delta$}] {};
            \end{scope}
        \end{scope}
    \end{tikzpicture}} \\
    \text{$\rD_\ell$} &
    \text{$\rE_6$} &
    \text{$\rE_7$}
\end{longtable}






$\Delta$, $\Sigma^+$, $\Sigma^-$.

By our assumption $\UU(\Sigma^+, R)$ is an abelian group.

Denote by $G$ the amalgamated product of $\St(\Phi, A[X])$ and the cyclic group $\mathbb{Z}$, whose generator we denote by $\sigma$ amalgamated over the following relations:
\begin{align}
    \sigma \cdot x_{\alpha}(Xf) \sigma^{-1} =& x_{\alpha} (f), & \alpha \in \Sigma^+, f \in A[X], \\
    \sigma \cdot x_{\beta}(f) \sigma^{-1}   =& x_{\beta} (Xf), & \beta \in \Sigma^-, f \in A[X], \\
    \sigma \cdot x_\gamma(f) \sigma^{-1}    =& x_\gamma(f), & \gamma \in \Delta, f \in A[X].
\end{align}
We denote by $i_+$ the canonical homomorphism $\St(\Phi, A[X]) \to G$.

The main result of this subsection is the following
\begin{prop}
    There exists an arrow $j$ making the diagram below commute:
    \[\begin{tikzcd}           & \St(\Phi, A[X, X\inv]) \arrow[rd, dashrightarrow, "j"] & \\
           \St(\Phi, A[X]) \arrow{ru}{h_+} \arrow{rr}{i_+} &                                & G.
    \end{tikzcd}\]
\end{prop}

\subsection{Construction of the relevant action}





Denote by $w_{\lambda, u}$ an element of the form $\prod w_{\alpha_i}(u_i) \in W(\Phi, A)$ such that $\prod u_i = u$, $\alpha_i \in \Sigma_k$ and $\varpi_k + \sum \alpha_i = \lambda$.
{\bf In this sum all $\alpha_i$'s are different!}
If $\lambda = \varpi_k$ set $w_{\lambda, \varpi_k}(u) = h_\alpha(u)$ for some $\alpha \in \Sigma_k$.
%There is a map $\iota \colon W(\Phi) \to W(\Phi, A)$ given by $s_{\alpha_i} \mapsto w_{\alpha_i}(\pm 1)$ (this does not depend on the choice of the set $S = \{s_{\alpha_i}\}_{\alpha_i \in \Pi}$ of simple reflections of $W(\Phi)$, however, it is {\it not} a homomorphism of groups).


\begin{lemma} \label{lem:can-repr} One has \[N(\varpi_k^\vee) \cdot \StW(\Phi, A) = \bigsqcup\limits_{(u, \lambda) \in A^\times \times \Lambda} N(\varpi_k^\vee) \cdot w_{\lambda, u}. \]
\end{lemma}
\begin{proof}
 First, we construct bijections between the following coset sets:
 \begin{equation}\label{eq:repr} \StW(\Delta, A) \setminus \StW(\Phi, A) \cong W(\Delta, A) \setminus W(\Phi, A) \xrightarrow{\cong} A^\times \times \Lambda.\end{equation}
 The first bijection exists since $A$ is local and $\K_2(\Phi, A) \cong \K_2(\Delta, A)$.

 Notice that for $w \in W(\Phi, A)$ there exists a unique weight $\lambda \in \Lambda$ such that the coordinate $(w \cdot v^+)_{\lambda, \varpi_k}$ is nonzero (here $v^+$ denotes the highest-weight vector). Denote this coordinate by $u$. Thus, the second map can be given by $w \mapsto (u, \lambda)$. Conversely, we can send each pair $(u, \lambda)$ to a representative $w_{\lambda, u}$. It is easy to see that the resulting $N(\varpi_k^\vee)$ does not depend on this choice.


 It remains to notice that $N(\varpi_k) \supseteq \StW(\Delta, A)$ and that for each $g \in N(\varpi_k)$ the element $\pi(g(0))$ stabilizes the highest weight vector $v^+$.
\end{proof}


Notice that for $g \in \StW(\Delta, A)$ one has $\chi_{\omega, X}(g) = g$ therefore we obtain the following
\begin{cor}
 The right-hand side of~\eqref{eq:sigma-def} does not depend on the choice of decomposition $x = x_1 \cdot x_2$, so $\sigma(\omega)$ is defined unambigously.
\end{cor}


\begin{comment}
We will also need to compute $x^{-1} \cdot \chi_{\omega, X}(x)$ for the representative $x = h_{\alpha_k}(u)\iota(w_\lambda)$. For simplicity, we may assume $w_\lambda = w_\beta(1)$, $\beta \in \Sigma_k$.
\begin{multline} x^{-1} \cdot \chi_{\omega, X}(x) = \{ X, u\} \cdot \iota(w_\lambda)^{-1} \chi_{\omega, X}(w_\lambda) = \\ = \{X, u\} \cdot w_\beta(1)^{-1} w_\beta(X)
\end{multline}
\end{comment}


Our next goal is to show that the function $\sigma(\omega)$ gives rise to a well-defined function
 \[\sigma(\omega)\colon V/\sim \to V/\sim.\]
The first ingredient is the following
\begin{lemma}
 For every $v \in V$ there exists $(a, b, 1) \in W$ such that $(a, b, 1) \star v \in V_\omega$.
\end{lemma}
\begin{proof}
 Choose some system of positive roots $\Phi^{+'}$ in such a way that $(\alpha, \omega) \geq 0$ for all $\alpha \in \Phi^{+'}$, i.\,e. $\UU(\Phi^{+'}, A) \subseteq N(\omega)$.
 From~\eqref{eq:bruhat} we obtain that \[G^+ = \UU(\Phi^{+'}, A)\cdot \St(\Phi, A[X], XA[X]) \cdot \StW(\Phi,A)\cdot \overline{\St}(\Phi, A, M) \cdot\UU(\Phi^+, A).\]
 The first two factors in the above decomposition are contained in $N(\omega)$, so the assertion follows from the definition of $\star$.
\end{proof}


\begin{lemma} \label{h-computation} Set $ x = w_{\lambda, u} = w_{\alpha'}(u) \cdot [w_{\alpha''}(1) \cdot w_{\alpha'''}(1)]$ for some $\alpha', \alpha'', \alpha''' \in \Sigma_k$ (or $x = h_{\alpha'}(u)$ if $\lambda = \varpi_k$). We claim that:
 \begin{equation*} h_{\alpha'}(1+m)^{x^{-1} \cdot \chi_{\varpi_k, X}(x)} = \left\{\begin{array}{ll} h_{\alpha'}(1+m) & \text{if $\lambda = \varpi_k$,}\\ \{X^2, 1+m\} \cdot h_{\alpha'}(1+m) & \text{otherwise.}\end{array}\right. \end{equation*}
\end{lemma}
\begin{proof}
In the case $\lambda = \varpi_k$ it is clear that $x^{-1} \cdot \chi_{\varpi_k, X}(x) \in \K_2(\Phi, A[X^{\pm 1}])$, so the assertion of the lemma is clear in this case.


Now suppose that $\lambda \neq \varpi_k$. We claim that $x^{-1} \cdot \widetilde{\chi}_{\omega, X}(x) \equiv h_{\alpha'}^{-1}(X)$ modulo $\K_2(\Phi, A[X^{\pm 1}])$. It is clear that lemma's assertion would follow from this.


We already know from~\cref{lem:winv-chiw} that
\[x_2^{-1} \cdot \widetilde{\chi}_{\omega, X}(x_2) \equiv w_{\alpha'}(u)^{-1} \cdot \widetilde{\chi}_{\omega, X}(w_{\alpha'}(u)) \equiv h_{\alpha'}^{-1}(X). \]
Now suppose that $x = w_{\alpha'}(u)\cdot w_{\alpha''}(1)$. Using the already established case we obtain that
\begin{multline*} x^{-1} \cdot \chi_{\omega, X}(x) \equiv w_{\alpha''}^{-1}(1) \cdot h_{\alpha'}^{-1}(X) \cdot \chi_{\omega, X}(w_{\alpha''}(1)) \equiv \\
\equiv h_{\alpha'}^{-1}(X) \cdot w_{\alpha''}^{-1}(X) \cdot \chi_{\omega, X}(w_{\alpha''}(1)) \equiv h_\alpha^{-1}(X). \end{multline*}
Here we use the fact that $\alpha' \neq \alpha''$.
Similar computation also applies in the case when $w_{\lambda, u}$ is a product of three Weyl elements.
\end{proof}


\begin{lemma}
 For every $w \in W$, $v \in V_\omega$ such that $v' = w \star v \in V_\omega$ there exists $w' \in W$ such that $\sigma(\omega)(w \star v) = w' \star \sigma(\omega)(v)$.
\end{lemma}
\begin{proof}
 It suffices to consider the case $\omega = \varpi_k^\vee$. Suppose that $v' = (x_1' x_2', y', z') = (a, b, 1) \star v$, where $v = (x_1 x_2, y, z)$. We have that
 \begin{equation}\label{eq:x-xprime} x_1' x_2' = x_1 x_2 \cdot \pi(b) \cdot a  \text{ for some }x_1, x_1' \in N(\omega),\ x_2, x_2' \in \StW(\Phi, A) \end{equation}
 and some $a \in \UU(\Phi^+, A[X]),\ b \in \St(\Phi, A[X], M[X])$. Thanks to~\cref{lem:can-repr} we may assume, without loss of generality, that $x_2 = w_{\lambda, u}$, $x_2' = w_{\lambda', u'}$
for some $u, u' \in A^\times$, $\lambda, \lambda' \in \Lambda$.


Evaluating both sides of~\eqref{eq:x-xprime} at $X=0$ and projecting them to $\St(\Phi, k)$ we obtain the equality $\overline{x_1'}(0) \cdot \overline{x_2'} = \overline{x_1}(0) \cdot \overline{x_2}\cdot \overline{a}(0).$
Since $x_1(0)$, $x_1'(0)$ and $a$ stabilize the highest weight vector we obtain that $\lambda = \lambda'$ and that $u - u' \in M$ (cf. the proof of~\cref{lem:can-repr}).
Again, without loss of generality we may assume $w_{\lambda, u} = w_{\alpha'}(u) \cdot [ w_{\alpha''}(1) \cdot w_{\alpha'''}(1)]$. Set $m = 1 - u/u'$, clearly $x_2 = c \cdot x_2' \cdot h_{\alpha'}(1 + m)$ for some $c \in \K_2(\Phi, A)$.


Set $\epsilon = 1$ if $\lambda\neq \varpi_k$, otherwise set $\epsilon = -1$.
From~\eqref{eq:chi-h},~\cref{lem:delta-k2-trivial} and~\cref{h-computation} we obtain that
\begin{equation}\label{eq:central-term} {x_2}^{-1} \cdot \chi_{\omega, X}(x_2) = \{1+m, X^\epsilon\} \cdot \bigl({x_2'}^{-1} \cdot \chi(\omega, x_2')\bigr), \end{equation}
while from~\eqref{eq:x-xprime} and \cref{delta-weyl} we get that
$\pi(b) \cdot a \cdot h_{\alpha'}(1 + m) \in N(\omega')$ for $\omega' = w_\lambda^{-1} \cdot \omega$. By~\cref{lem:q} we can find $q \in \UU(\Phi^+, M[X])$ such that $a q^{-1}$ and the image of $b' = q \cdot b^a \cdot h_{\alpha'}(1+m) \in \St(\Phi, A[X], M[X])$ under $\pi$ both belong to $N(\omega')$.


\begin{multline} \label{eq:computation1}
 \sigma(\omega)(x_1'x_2', y', z') =
 \bigl(\delta_\omega(x_1') \cdot x_2',\, x_2'^{-1}\cdot \chi_{\omega, X}(x_2' y'),\, \chi_{\omega, X}(z')\bigr) = \\
 = \bigl(\delta_\omega(x_1) \cdot \delta_\omega(x_2 \pi(b) a {x_2'}^{-1}) \cdot x_2',\, \{X^\epsilon, 1+m\} \cdot x_2^{-1}\cdot \chi_{\omega, X}(x_2 y'), \chi_{\omega, X}(z') \bigr) = \\
 = \bigl(\delta_\omega(x_1) \cdot x_2 \cdot \delta_{\omega'}(aq^{-1}) \cdot \delta_{\omega'}(\pi(b')) \cdot h^{-1}_{\alpha'}(1+m),\, \{X^\epsilon, 1+m\} \cdot x_2^{-1}\cdot \chi_{\omega, X}(x_2 y'), \widetilde{\chi}_{\omega, X}(z') \bigr) = \\
 = (1, 1, \widetilde{\chi}_{\omega', X}(b') \cdot h_{\alpha'}^{-1}(1+m)) \star \\ \star \bigl(\delta_\omega(x_1) \cdot x_2 \cdot \delta_{\omega'}(aq^{-1}),\, \{X^\epsilon, 1+m\} \cdot x_2^{-1}\cdot \chi_{\omega, X}(x_2 y'), \bigl(\widetilde{\chi}_{\omega', X}(b') h^{-1}_{\alpha'}(1+m)\bigr)^{x_2^{-1} \cdot \chi_{\omega, X}(x_2 y')} \widetilde{\chi}_{\omega, X}(z') \bigr).
\end{multline}


Now let us compute the third coordinate:
\begin{multline} \bigl(\widetilde{\chi}_{\omega', X}(b') \cdot h^{-1}_{\alpha'}(1+m)\bigr)^{x_2^{-1} \cdot \chi_{\omega, X}(x_2 y')} \widetilde{\chi}_{\omega, X}(z') = \\ =
\bigl(\widetilde{\chi}_{\omega', X}(q \cdot b^a \cdot h_{\alpha'}(1+m)) \cdot h^{-1}_{\alpha'}(1+m)\bigr)^{x_2^{-1} \cdot \chi_{\omega, X}(x_2 y')} \widetilde{\chi}_{\omega, X}(b^{-y}z) = \text{by~\cref{h-computation}}  \\ = \bigl(\widetilde{\chi}_{\omega, X}((q \cdot b^a \cdot h_{\alpha'}(1+m))^{x_2^{-1}}) \bigr)^{\chi_{\omega, X}(x_2 y')} \cdot h_{\alpha'}(1+m)^{-\chi_{\omega, X}(y')} \cdot \{1 + m, X^{\epsilon + 1} \} \cdot \widetilde{\chi}_{\omega, X}(b^{-y}z) = \\ = \widetilde{\chi}_{\omega, X}\bigl((q \cdot b^a \cdot h_{\alpha'}(1+m))^{y'}\bigr) \cdot \widetilde{\chi}_{\omega, X}\bigl(h_{\alpha'}(1+m)\bigr)^{-\chi_{\omega, X}(y')} \cdot \{1 + m, X^\epsilon \} \cdot \widetilde{\chi}_{\omega, X}(b^{-y}z) = \\ = \{ 1+m, X^\epsilon \} \cdot \widetilde{\chi}_{\omega, X}(q^{y'} \cdot z).
\end{multline}


Now recalling that $y' = a ^{-1} y, z' = b^{-y} z$ we can continue~\eqref{eq:computation1} as follows:
\begin{multline*}
 \bigl(\delta_\omega(x_1) \cdot x_2 \cdot \delta_{\omega'}(aq^{-1}),\, x_2^{-1}\cdot \chi_{\omega, X}(x_2 y'), \widetilde{\chi}_{\omega, X}(q^{y'} z) \bigr) = \\ = (\delta_{\omega'}(qa^{-1}), 1, \chi_{\omega, X}(q^{y'})) \star \bigl(\delta_\omega(x_1) \cdot x_2,\, \cdot \chi_{\omega', X}(aq^{-1}) \cdot x_2^{-1}\cdot \chi_{\omega, X}(x_2 q a^{-1} \cdot y ), \widetilde{\chi}_{\omega, X}(z) \bigr) = \\ = (\ldots) \star (\delta_\omega(x_1) \cdot x_2,\, x_2^{-1} \chi_{\omega, X}(x_2y), \widetilde{\chi}_{\omega, X}(z)) \end{multline*} \end{proof}


 For $w\in W(\Phi)$ denote by $\Stab_{w}$ the algebraic subgroup of $\G_{sc}(\Phi, -)$ consisting of elements stabilizing the vector $\iota(w) \cdot v^+$. It is clear that the resulting subgroup does not depend on the exact choice of $\iota$. Recall that the projection $\varphi \colon \St(\Phi, R) \to \G_{sc}(\Phi, R)$ is always injective on unipotent subgroups. Moreover, it is clear that $N(w \cdot \varpi_k)(0) = \varphi^{-1}(\Stab_w(A[X]))$.

\begin{lemma} \label{lem:q}
Let $R$ be a commutative ring, $I$ be an ideal of $R$.
Suppose that $a \in \UU(\Phi^+, R)$ is such that its image $\varphi(\overline{a})$ lies in $\Stab_{w}(R/I)$ for some $w \in W(\Phi)$.
Then there exists $q \in \UU(\Phi^+, I)$ such that $\varphi(aq)$ lies in $\Stab_{w}(R)$.
\end{lemma}
\begin{proof}
Set $b = a^{\iota(w)}$.
Notice that $(b \cdot v_+)_{\varpi_k} = 1$, therefore by the Chevalley--Matsumoto decomposition we can write $b = b_1 \cdot b_2$ for some $b_1$ such that $\varphi(b_1) \in \Stab_1(R)$ and $b_2 \in \UU(\Sigma_k^-, R)$.
It is also clear from our assumptions that $b_2$, in fact, belongs to $\UU(\Sigma_k^-, I)$.
Set $a_i = {}^{\iota(w)}b_i$.
It is clear that $\varphi(a_1) \in \Stab_w(R)$, $\varphi(a_2) \in \UU(\Phi^+ \cap w(\Sigma_k^-), I)$ and $a = a_1 \cdot a_2$ as claimed.
\end{proof}
\subsection{Construct sigma-morphisms by amalgamating relevant sigma-morphisms}

\subsection{Construction of sigma-morphisms in rank 3}
\input{appendix}