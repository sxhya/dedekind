\usepackage{amssymb}\begin{dfn}
    Let $K$ be a functor from commutative rings to groups.
    Recall from~\cite{LSV2} that $K$ is called \textit{locally acyclic (resp., locally acyclic for domains)} if for every commutative local ring (resp., domain)
     $A$ the following diagram whose arrows are induced by natural embeddings is a pullback square:
    \begin{equation}\label{eq:P1-square} \begin{tikzcd} K(A) \ar[r] \ar[d] & K(A[X]) \arrow{d} \\ K(A[X\inv]) \ar{r} & K(A[X, X\inv]). \end{tikzcd} \end{equation}
\end{dfn}

Now we can formulate the main result of this section.
\begin{thm}[Horrocks theorem for $\K_2$]\label{thm:horrocks-k2}
Let $\Phi$ be a root system of type $\rA_{\geq 4}$, $\rD_{\geq 5}$, $\rE_6$ or $\rE_7$.
Then the functor $\K_{2}(\Phi, -)$ is locally acyclic for domains.
\end{thm}
Horrocks theorem for $\K_2$ has been previously known in the linear and even orthogonal case $\Phi=\rA_{\geq 4},\rD_{\geq 7}$, see~\cite[Proposition~4.3]{Tu83} and~\cite[Theorem~1]{LS20}, respectively.
Notice that the orthogonal Horrocks theorem for $\K_2$ \cite[Theorem~1]{LS20} was proved only under the additional assumption $2 \in A^\times$.
Thus, the novelty of~\cref{thm:horrocks-k2} consists not only in the fact that it applies to root systems of types $\rD_5$, $\rD_6$, $\rE_6$, $\rE_7$ but also that
 it is proved without the assumption $2 \in A^\times$.

Since our proof of \cref{thm:horrocks-k2} is rather long and technical we will first try to describe its plan.

Let $A$ be a local ring with maximal ideal $M$ and residue field $k$.
Recall that proofs of the Horrocks theorem for $\K_1$ are usually based on the decomposition of the elementary subgroup over Laurent polynomial ring
 called \textit{Suslin's lemma} or \textit{Suslin's structure theorem}, cf.~\cite{Abe83, Su77}, \cite[\S~VI.6]{Lam10}.
In the linear case this decomposition asserts that the elementary linear group $\E(n, A[X, X\inv]) = \Esc(\rA_{n-1}, A[X, X\inv])$ admits the following group factorization for $n \geq 3$:
\begin{equation}\label{eq:triple-decomposition}
\E(n, A[X^{\pm 1}]) = \E(n, A[X]) \cdot B(A[X^{\pm 1}]) \cdot \E(n, A[X^{\pm 1}], M[X^{\pm 1}]).
\end{equation}
In the above formula $\E(n, R, I)$ denotes the relative elementary subgroup, i.\,e. the kernel of the canonical reduction homomorphism $\E(n, R) \to \E(n, R/I),$
 while $B(R)$ denotes the Borel subgroup (i.\,e. the semidirect product of the unipotent radical $\UU(\Phi^+, R)$ and the group of diagonal matrices).

To prove the Suslin's structure theorem one constructs a collection of diagonal automorphisms $\delta_i$, $1\leq i\leq n$
 and shows that the product $V$ of the three subgroups in the right-hand side of~\eqref{eq:triple-decomposition} is stabilized by these automorphisms.
On the other hand, the product $V$ is clearly stabilized by left translations by elements of $\E(n, A[X])$.
The decomposition~\eqref{eq:triple-decomposition} then follows the fact that the minimal subgroup of $\E(n, A[X, X\inv])$ that contains the image of $\E(n, A[X])$ and at the same time is invariant with respect to the action of all $\delta_i$
  coincides with $\E(n, A[X, X\inv])$.

Tulenbaev's proof of the Horrocks theorem for $\K_2$ is similar to Suslin's proof of the Horrocks theorem for $\K_1$.
The main difference, however, is that simply proving an analogue of factorization~\eqref{eq:triple-decomposition} for the Steinberg group $\St(\Phi, A[X, X\inv])$
 would not be sufficient.
Instead, one has to prove a much more precise result, namely one has to construct a ``model set'' $V$ for the group $\St(\Phi, A[X, X\inv])$
 out of the same three ingredient groups: $\St(\Phi, A[X])$, Borel subgroup and the relative group $\St(\Phi, A[X^\pm], M[X^\pm])$.
By a ``model set'' we mean a set upon which $\St(\Phi, A[X, X\inv])$ would act simply-transitively.
This technique probably dates back to~\cite{ST76}, where it was used to prove the injective stability theorem for $\K_2$, it was also reused
 by M.~Tulenbaev in his proof of the Horrocks theorem for $\K_2$ in the linear case, cf.\ Propositions 4.1 and 4.3 in~\cite{Tu83}.
The same technique is also used in the proof of~\cite[Theorem~3]{LS20}, which is a direct generalization of~\cite[Proposition~4.3]{Tu83}.
We will use the same technique for the proof of~\cref{thm:horrocks-k2}, which, by analogy, should be thought of as a generalization of~\cite[Proposition~4.1]{Tu83}.

Now let us list the key steps of the proof:
\begin{itemize}
    \item Step 1. First of all, in~\cref{subsec:triples} we introduce abstract formalism of group decompositions which will allow us to construct the set $V$ modeling the Steinberg group $\St(\Phi, A[X, X\inv])$.
                  This should be thought of as preparatory work needed for the formulation of the $\K_2$-analogue of Suslin's structure theorem~\eqref{eq:triple-decomposition}.
    \item Step 2. In~\cref{subsec:structure-theorem-overview} we use this formalism to construct the "model set" $V$ and, thus, formulate the $\K_2$-analogue of Suslin's structure theorem precisely.
                  We also show how~\cref{thm:horrocks-k2} can be reduced to a concrete technical statement, namely,
                  to the existence of the action of $\St(\Phi, A[X, X\inv])$ on $V$.
\end{itemize}
Obviously, \cref{prop:rel-poly-Laurent} reduces the problem of construction of the action of $\St(\Phi, A[X, X\inv])$ on $V$ to the construction of
 the automorphism $\delta_{\varpi_k}$ of $V$ modeling the action of the weight automorphism $\chi_{\varpi_k, X}$ (cf.~\cref{subsec:weight-automorphisms}).
Here index $k$ has the same meaning as in Figure 1 of~\cref{subsec:curtis-tits}, namely it is the index of the simple root marked green on the extended Dynkin diagram.
The construction of $\sigma_k$ proceeds as follows:
\begin{itemize}
    \item Step 3. First, we have to show the existence of $\varpi_k$-pair in the sense of~\cref{dfn:delta-pair}.
                  Firstly, we construct $\varpi_1$-pair for the root system of type $\rA_3$ using the presentation from~\cref{prop:rel-presentation} for this purpose.
                  Next, we use the amalgamation theorem~\cref{thm:relPres} to obtain the general result.
                  This is achieved in~\cref{subsec:construction-sigma}.
    \item Step 4. Finally, we complete the construction of the action of $\St(\Phi, A[X, X\inv])$ on $V$ and verify all the neccessary relations.
                  This is achieved in~\cref{sec:construction-delta}.
\end{itemize}

\subsection{Formalism of triples}\label{subsec:triples}
Let $N$ be a group acting on itself by right conjugation.
Let $M$ be a group with a right action of $N$.
Recall that a group homomorphism $\mu\colon M \to N$ is called a \textit{precrossed module} if $\mu$ preserves the action of $N$, i.\,e.
\[\mu(m^n) = \mu(m)^n, \text{for all $m \in M$, $n\in N;$} \]
If, in addition, $\mu$ satisfies the so-called \textit{Peiffer identity}, i.\,e.
\[{m}^{\mu(m')} = {m'}^{-1} m m', \text{for all $m, m' \in M$,}\]
then $\mu$ is called a \textit{crossed module}.

If $\mu\colon M \to N$ and $\mu' \colon M' \to N'$ is a pair of precrossed modules.
A \textit{map of precrossed modules} $(f, g)\colon \mu \to \mu'$ is a pair of group homomorphisms $f\colon M \to M'$, $g\colon N \to N'$ such that
$\mu'f = g \mu$ and that the action of $N$ is preserved, i.\,e. ${f(m)}^{g(n)} = f(m^n)$ for all $n \in N$, $m \in M$.

Now suppose that we are given the following cube-like commutative diagram of abstract groups:
\begin{equation} \label{eq:cube} \begin{split} \xymatrix{
    G_{123} \ar[rr]_{f_{23}} \ar[dd]_{f_{12}} \ar[rd]_{f_{13}} &                        & G_{23} \ar@{-->}[dd]^(.3){g_2^3} \ar[rd]^{g^2_3} &           \\
    & G_{13} \ar[rr]^(.3){g^1_3} \ar^(.3){g^3_1}[dd] &                   & G_3 \ar[dd]_{h_3} \\
    G_{12} \ar@{-->}[rr]^(.3){g_2^1} \ar[rd]_{g_1^2}          &                        & G_2 \ar@{-->}[rd]_{h_2}         &           \\
    & G_1 \ar[rr]_{h_1}              &                   & G.} \end{split} \end{equation}
Additionally, we make the following assumptions:
\begin{itemize}
    \item $g_1^3$ is a precrossed module;
    \item $h_3$ is a crossed module;
    \item $(g_3^1, h_1) \colon g_1^3 \to h_3$ is a map of precrossed modules.
\end{itemize}
Set $V = G_1 \times G_2 \times G_3$, $W = G_{12} \times G_{13} \times G_{23}$.
We define an operation $\star \colon W \times V \to V$ as follows.
For $v = (x, y, z) \in V$ and $w = (a, b, c) \in W$ we set
\[(a, b, c) \star (x, y, z) = (x \cdot g_1^3(b) \cdot g_1^2(a),\ g_2^1(a)^{-1} \cdot y \cdot g_2^3(c),\ g_3^2(c)^{-1} \cdot g_3^1(b)^{-h_2(y)} \cdot z).\]
Consider the set-theoretic map $h \colon V \to G$ given by $(x, y, z) \mapsto h_1(x) \cdot h_2(y) \cdot h_3(z)$.
It is clear from the definition of $\star$-operation that for $w \in W$ one has $h(w \star v) = h(v).$
Now let us define the relation associated with $\star$-operation.
We declare two elements $v, v' \in V$ congruent (denoted $v \sim_W v'$) if $v' = w \star v$ for some triple $w=(a, b, c) \in W$.
As the following lemma shows, this relation is an equivalence relation.
\begin{lemma} For every $v \in V$ one has
\begin{equation*}(a', b', c') \star \left( (a, b, c) \star v \right) = (a \cdot a', b \cdot {b'}^{g_1^2(a)^{-1}}, c \cdot c') \star v.\end{equation*}
\end{lemma}
\begin{proof}
    Set $v'=(x', y', z') = (a, b, c) \star v$ and $(x'', y'', z'') = (a', b', c') \star v'$.
    Since $g_1^3$ is a precrossed module we immediately obtain that
    \begin{align*}
        x'' =& x' \cdot g_1^3(b') \cdot g_1^2(a') = x \cdot g_1^3(b) \cdot g_1^2(a) \cdot g_1^3(b') \cdot g_1^2(a') = x \cdot g_1^3(b \cdot b'^{g_1^2(a)^{-1}}) g_1^2(a \cdot a'),\\
        y'' =& g_2^1(a')^{-1} \cdot g_2^1(a)^{-1} \cdot y \cdot g_2^3(c) \cdot g_2^3(c') = g_2^1(a\cdot a')^{-1} \cdot y \cdot g_2^{3}(c\cdot c'). \end{align*}
    Since $(g_3^1, h_1)$ is a map of precrossed modules, for every $a \in G_{12}$, $b \in G_{13}$ one has $g_3^1(b^{g_1^2(a)}) = g_3^1(b)^{h_1 g_1^2(a)} = g_3^1(b)^{h_2g_2^1(a)}$.
    Since $h_3$ satisfies Peiffer identity, for every $c \in G_{23}$ and $z \in G_3$ one has $z ^{h_2 g_2^3(c)} = z^{ h_3 g_3^2(c)} = g_3^2(c)^{-1} \cdot z \cdot g_3^2(c)$.
    Using these identities we obtain that
    \begin{multline*}
        z'' = g_3^2(c')^{-1} \cdot g_3^1(b')^{-h_2(y')} \cdot z' = \\
        = g_3^2(c')^{-1} \cdot g_3^1(b')^{- h_2 \left( g_2^1(a)^{-1} \cdot y \cdot g_2^3(c) \right)} g_3^2(c)^{-1} \cdot g_3^1(b)^{-h_2(y)} \cdot z = \\
        = g_3^2(c \cdot c')^{-1} \cdot g_3^1(b')^{- h_2 \left( g_2^1(a)^{-1} \cdot y \right)} \cdot g_3^1(b)^{-h_2(y)} \cdot z = \\
        = g_3^2(c \cdot c')^{-1} \cdot g_3^1(b \cdot {b'} ^ {g_1^2(a)^{-1}})^{- h_2 \left( y \right)} \cdot z. \qedhere
    \end{multline*}
\end{proof}
Since $h$ is constant on the orbits of $\star$-action, $h$ gives rise to a well-defined map $\overline{h} \colon V/\sim_W \to G$.
We use the notation $[a, b, c]$ to denote the equivalence class of the triple $(a, b, c) \in V$.

\begin{lemma}\label{lem:one-one-z} Assume that the back face $(f_{12}, f_{23}, g_2^1, g_2^3)$ of~\eqref{eq:cube} is a pullback square.
Assume additionally that $[1, 1, 1] = [1, 1, z]$ for some $z\in G_3$.
Then $z \in g_3^1(\Ker(g_1^3)).$ \end{lemma}
\begin{proof} By the definition of congruence relation there exists $(a, b, c)\in W$ such that
\[ (a, b, c) \star (1, 1, 1) = ( g_1^3(b) \cdot g_1^2(a),\ g_2^1(a)^{-1} \cdot g_2^3(c),\ g_3^2(c)^{-1} \cdot g_3^1(b)^{-1}) = (1,1,z). \]
By lemma's assumption there exists $e \in G_{123}$ such that $f_{12}(e) = a$, $f_{23}(e) = c$, hence
\[ 1 = g_1^3(b) \cdot g_1^2(f_{12}(e)) = g_1^3(b \cdot f_{13}(e)),\ z = g_3^2(f_{23}(e))^{-1} \cdot g_3^1(b)^{-1} = g_3^1(b \cdot f_{13}(e))^{-1}. \qedhere\] \end{proof}


\subsection{First reductions} \label{subsec:structure-theorem-overview}
%sSignificant progress towards proving~\cref{thm:horrocks-k2} has already been achieved in~\cite{LS20}.
%In this subsection we reduce~\cref{thm:horrocks-k2} to a specific technical statement which will be addressed in the following sections.

The following lemma provides the first key reduction in the proof of~\cref{thm:horrocks-k2}.
\begin{lemma} \label{lem:first-reduction}
Let $A$ be a local ring with maximal ideal $M$ and residue field $\kappa$.
Let $\Phi$ be as in the statement of~\cref{thm:horrocks-k2}.
Suppose that the canonical homomorphism
\begin{equation} \label{eq:c-surj} C(\Phi, A[X], M[X]) \to C(\Phi, A[X, X\inv], M[X, X\inv]) \end{equation}
is surjective.
Then the square~\eqref{eq:P1-square} is pullback and Horrocks theorem for $\K_2$ holds.
\end{lemma}
\begin{proof}
    Denote by $R$ the Laurent polynomial ring $A[X, X\inv]$ and by $B$ the subring $A[X\inv] + M[X] \subseteq R$.
    We also set $I \subseteq M[X, X\inv]$, which is clearly an ideal of both $B$ and $R$.
    Consider the following diagram with rows obtained from~\eqref{eq:relative-Steinberg}:
    \[\begin{tikzcd}
          C(\Phi, B, I) \arrow{r} \arrow[d, swap, twoheadrightarrow] & \St(\Phi, B, I) \arrow{r}{\mu_B} \arrow{d} & \St(\Phi, B) \arrow{r} \arrow{d} & \St(\Phi, \kappa[X^{-1}]) \arrow[hookrightarrow]{d} \\
          C(\Phi, R, I) \arrow{r} & \St(\Phi, R, I) \arrow{r}{\mu_R} \arrow[ur, "t", dashrightarrow] & \St(\Phi, R) \arrow{r} & \St(\Phi, \kappa[X, X^{-1}]).
    \end{tikzcd}\]
    The lifting $t$ is obtained from~\cite[Lemma~3.3]{LS20}.
    The right-hand side vertical arrow is injective by~\cite[Lemma~2.2]{LS20}.
    The left-hand side vertical arrow is surjective since the composite arrow
    $\xymatrix{ C(\Phi, A[X], M[X]) \ar[r] & C(\Phi, B, I) \ar[r] & C(\Phi, R, I) }$
    is surjective by lemma's assumption.
    It remains to repeat the diagram chasing argument of~\cite[Theorem~1]{LS20} to conclude that the homomorphism $\St(\Phi, B) \to \St(\Phi, A[X, X\inv])$ is injective.
    The assertion of the lemma will then follow from~\cite[Theorem~3]{LS20}.
\end{proof}
The proof of Horrocks theorem is, thus, reduced to showing that~\eqref{eq:c-surj} is surjective for every local domain $(A, M)$.
We need to shorter notation for certain subgroups of $\St(\Phi, R)$.

%Not let us introduce shorter notation for Steinberg groups and their subgroups relevant for the proof of Horrocks theorem.
{\allowdisplaybreaks\begin{align*}
    G     =& \St(\Phi, A[X, X^{-1}]),\\
    G^+   =& \St(\Phi, A[X]),\\
    B     =& \UU(\Phi^+, A[X, X\inv]) \rtimes \StH(\Phi, A[X, X\inv]) \leq G,\\
    G_M   =& \St(\Phi, A[X, X^{-1}], M[X, X^{-1}]),\\
    U^+   =& \UU(\Phi^+, A[X]),\\
    G^+_M =& \St(\Phi, A[X], M[X]),\\
    B_M   =& \UU(\Phi^+, M[X, X^{-1}]) \times \{X, 1+M\} \leq G_M,\\
    U^+_M =& \UU(\Phi^+, M[X]).
\end{align*}}
In the definition of $B_M$ we denote by $\{X, 1+M\}$ the image of the homomorphism $\{X, -\}_{r}$ from~\eqref{eq:relative-symbol}.

The above groups can be organized into the following commutative diagram:
\begin{equation} \label{eq:cube-Steinberg} \xymatrix{
    U^+_M \ar@{^{(}->}[rr] \ar@{^{(}->}[dd] \ar@{^{(}->}[rd] &                        & B_M \ar[dd]^(.3){g_B^M} \ar@{^{(}->}[rd]^{g^B_M} &           \\
    & G^+_M \ar[rr]^(.3){g^+_M} \ar^(.3){g^M_+}[dd] &                   & G_M \ar[dd]_{h_M} \\
    U^+ \ar@{^{(}->}[rr]^(.3){g_B^+} \ar@{^{(}->}[rd]_{g_+^B}          &                        & B \ar@{^{(}->}[rd]_{h_B}       &           \\
    & G^+ \ar[rr]_{h_+}              &                   & G.}\end{equation}
Here $g^M_+$ and $h_M$ are just renamed homomorphisms $\mu$ from~\eqref{eq:relative-Steinberg}.
The homomorphism $g^M_B$ is also induced by $\mu$.
Maps $g_M^+$ and $h^+$ are induced by the ring embedding $A[X] \to A[X, X\inv]$.
The other homomorphisms on the diagram are all obvious subgroup embeddings.

Set $V = G^+\times B \times G_M$, $W = U^+\times G^+_M \times B_M$.
Both homomorphisms $g_+^M$ and $h_M$ are crossed modules by~\cref{lem:rel-Steinberg-crossed-module}.
The fact that $(g^+_M, h_+)$ is a map of precrossed modules is obvious.
Thus, we find ourselves in the situation of~\cref{subsec:triples}.

The following lemma provides the second key reduction in the proof of Horrocks theorem.
\begin{lemma} \label{lem:second-reduction}
    Suppose that $A$ is a domain.
    Suppose that $V/\sim_W$ admits an action of $G$ such that
      for $g \in G_M$ one has \[ h_M(g) \cdot [1, 1, 1] = [1, 1, g]. \]
    Then the canonical homomorphism~\eqref{eq:c-surj} is surjective.
\end{lemma}
\begin{proof}
  Since $A$ is a domain, $g^M_B$ is injective by~\cref{lem:symbols}.
    Thus, the back face of~\eqref{eq:cube-Steinberg} is pull-back.
  Notice that for any $g \in C(\Phi, A[X, X\inv], M[X, X\inv]) \subseteq G_M$ one has
    \[ [1, 1, 1] = h_M(g) \cdot [1, 1, 1] = [1, 1, g].\]
  It is clear now that $g$ lies in the image of $C(\Phi, A[X], M[X])$ under $g^+_M$ by~\cref{lem:one-one-z}.
\end{proof}

\begin{rem}
    Notice that in the linear case the symbol homomorphism $A^\times \to \K_2(A[X, X\inv])$, $a \mapsto \{a, X\}$ admits section
     for a general commutative ring $A$ by~\cite{Wa71}.
    Thus, in the linear case the assertion of the lemma remains true without the assumption that $A$ is a domain, cf.~\cite[Lemma~3.1g]{Tu83}.
\end{rem}

\subsection{Construction of the homomorphism $\sigma(\varpi_k$)} \label{subsec:construction-sigma}
\input{pairconstr}

\subsection{Construction of the action of $\St(\Phi, A[X, X\inv])$ on $V$} \label{sec:construction-delta}
From now on we assume that $A$ is a local ring.
Recall from \cref{subsec:structure-theorem-overview} that \[V = G^+ \times B \times G_M,\ W = U^+ \times G_M^+ \times B_M\]
and that $W$ acts upon $V$ via $\star$-action defined in~\cref{subsec:triples}.

For a weight $\omega \in P(\Phi)$ denote by $V_\omega$ the subset of $V$ consisting of those triples $v = (x, y, z)$ for which $x \in N_\omega\cdot \StW(\Phi, A)$.
Throughout this section we assume that $\Phi$ is a root system of type $\rD_{\geq 4}$, $\rE_6$ or $\rE_7$.

\begin{dfn} \label{sigma-def}
  For $\omega = \pm \varpi_k$, where $k$ is the same as in the statement of \cref{thm:pairconstr},
  we define the function $\delta_\omega \colon V_\omega \to V_{-\omega}$ via the following formula:
  \begin{equation} \label{eq:sigma-def} \delta_\omega(x_1 \cdot x_2, y, z) \mapsto (\sigma(\omega)(x_1)\cdot x_2, x_2^{-1} \cdot \chi_{\omega, X}(x_2 \cdot y), \widetilde{\chi}_{\omega, X}(z)), \end{equation}
  where $x_1 \in N(\omega)$, $x_2 \in \StW(\Phi, A)$,  $y \in B$, $z \in G_M$.
\end{dfn}

In the above definition $\chi_{\omega, X}$ and $\widetilde{\chi}_{\omega, X}$ denote homomorphisms defined in~\cref{subsec:weight-automorphisms},
 while $\sigma(\omega)$ is the homomorphism constructed in~\cref{thm:pairconstr}.

By~\cref{lem:winv-chiw} the factor $x_2^{-1} \cdot \chi_{\omega, X}(x_2)$ lies in $\StH(\Phi, A[X^{\pm 1}])$,
 so the second component of the above triple belongs to $B$.
At this point, it is not immediately clear why the above definition does not depend on the choice of decomposition $x = x_1 \cdot x_2$.

Denote by $\Lambda$ the set of microweights of $\Phi$.
Recall that $\Lambda$ coincides with the orbit set $W(\Phi) \cdot \varpi_k$.
Since $W(\Delta_k)$ stabilizes $\varpi_k$ we obtain that the coset set $W(\Phi)/W(\Delta_k)$ is in one-to-one correspondence with $\Lambda$.

We denote by $V$ the microweight representation of $\Gsc(\Phi, A)$ with the highest weight $\varpi_k$ (see e.\,g. \cite[\S~2]{Ge17} or \cite[\S~1.1]{V00}).
This representation has dimension $|\Lambda|$ and we denote by $v^\lambda$ its basis vector corresponding to $\lambda \in \Lambda$.
We also denote by $v^+$ the highest weight vector of this representation, i.\,e. the basis vector $v^{\varpi_k}$.
A choice of the system of positive roots specifies a strict partial order on $\Lambda$.
By definition, $\lambda > \mu$ if $\lambda - \mu$ is a sum of positive roots.

Recall that for every $w \in W(\Phi, A)$ there exists a unique $\lambda \in \Lambda$ and $u \in A^\times $ such that
 \begin{equation}\label{eq:w-highestweight} w \cdot v^\lambda = u^{-1} v^+. \end{equation}
Conversely, for every pair $(u, \lambda) \in A^\times \times \Lambda$ there exists some element $w = w_{\lambda, u} \in W(\Phi, A)$ such that~\eqref{eq:w-highestweight} holds.
    If $\lambda = \varpi_k$ the element $w_{\lambda, u}$ can be chosen as $h_\alpha(u)$ for some $\alpha \in \Sigma_k^-$, $u \in A^\times$, cf.~\cite[Lemma~7]{V00}.
    If $\lambda \neq \varpi_k$ by~\cite[Lemma~6]{V00} the element $w_{\lambda, u}$ can be chosen as a product of \textit{at most} $n$ elements
     $w_{\beta_i}(v_i)$, $1 \leq i \leq n$, for $\beta_i\in\Sigma_k^-$ such that $\beta_i$ are mutually orthogonal and $\prod_i v_i = \pm u$ and $\varpi_k + \sum_i \beta_i = \lambda$ where
    \begin{itemize}
        \item $n=2$ if $\Phi = \rD_\ell, \rE_6$,
        \item $n=3$ if $\Phi = \rE_7$.
    \end{itemize}
    Formula~\eqref{eq:w-highestweight} follows from the description of the action of $w_\beta(v)$ on $V$ given by~\cite[Lemma~6]{V00}.
    It is also clear that $\overline{w_{\lambda, u}} \in W(\Phi)$ swaps weights $\varpi_k$ and $\lambda$.


\begin{lemma} \label{h-computation} For $x = w_{\lambda, u}$ one has
 \begin{equation*}
      h_{\alpha}(1+m)^{x^{-1} \cdot \chi_{\varpi_k, X}(x)} =  \left\{
       \begin{array}{ll}
           h_{\alpha}(1+m) & \text{if $\lambda = \varpi_k$,}\\
           \{X^{-\sum_i\langle \alpha, \beta_i \rangle}, 1+m\} \cdot h_{\alpha}(1+m) & \text{otherwise.}\end{array}
      \right.
 \end{equation*}
\end{lemma}
\begin{proof}
In the case $\lambda = \varpi_k$ it is clear from~\eqref{eq:chi-h} that $x^{-1} \cdot \chi_{\varpi_k, X}(x) \in \K_2(\Phi, A[X^{\pm 1}])$,
 so the assertion of the lemma is clear in this case.

Now suppose that $\lambda \neq \varpi_k$.
From the proof of~\cref{lem:winv-chiw} and the fact that $\beta_i$ are mutually orthogonal we obtain that
\begin{multline*}
    x^{-1} \cdot \chi_{\varpi_k, X}(x) =
     \prod {w_{\beta_i}^{-1}(v_i) \cdot \chi_{\varpi_k, \omega}(w_{\beta_i}(v_i))} =
     \{ X^{-1}, \prod_i v_i \} \prod_i h_{\beta_i}^{-1}(X^{-1}).
\end{multline*}
    From~\cite[Lemme~5.2(e)]{Ma69} and~\eqref{eq:steinberg} we know that ${}^{h_\beta(v)}h_\alpha(u) = \{v^{\langle \alpha, \beta \rangle}, u\} \cdot h_\alpha(u)$
     from which the assertion of the lemma follows.
\end{proof}

\begin{lemma} \label{lem:can-repr}
  For $\omega = \pm \varpi_k$ one has \[N_{\omega} \cdot \StW(\Phi, A) = \bigsqcup\limits_{(u, \lambda) \in A^\times \times \Lambda} N_{\omega} \cdot w_{\lambda, u}. \]
\end{lemma}
\begin{proof}
  First of all, observe that the natural homomorphism $\K_2(\Delta_k, A) \to \K_2(\Phi, A)$ is surjective.
  This follows from the fact that both groups are generated by Steinberg symbols by~\cite[Theorem~2.5]{Ste73}.
  Consequently, the coset set $\StW(\Phi, A) / \StW(\Delta_k, A)$ is in bijective correspondence with the coset set $W(\Phi, A)/W(\Delta_k, A)$.

  Now we claim that the coset set $W(\Phi, A)/W(\Delta_k, A)$ is isomorphic to the set $A^\times \times \Lambda$
   via the mapping $w W(\Delta_k, A) \mapsto (u, \lambda)$, where $u$ is determined from~\eqref{eq:w-highestweight}.
  This map is obviously surjective, its injectivity follows from Chevalley--Matsumoto decomposition~\cite[Theorem~1.3]{St78}
   and the fact that $W(\Phi, A) \cap \Gsc(\Delta_k, A) = W(\Delta_k, A)$.

  It remains to notice that $N_{\omega} \supseteq \StW(\Delta_k, A)$ and that for each $g \in N_{\omega}$ the element $\pi(g(0))$ stabilizes the highest weight vector $v^+$.
\end{proof}

Notice that for $g \in \StW(\Delta, A)$ one has $\chi_{\omega, X}(g) = g$ therefore we obtain the following
\begin{cor}
 The right-hand side of~\eqref{eq:sigma-def} does not depend on the choice of decomposition $x = x_1 \cdot x_2$, so $\delta_\omega$ is defined unambigously.
\end{cor}

\begin{lemma} \label{lem:v-correctness1}
 For every $v \in V$ there exists $(a, b, 1) \in W$ such that $(a, b, 1) \star v \in V_\omega$.
\end{lemma}
\begin{proof}
 Choose system of positive roots $\Phi^+'$ as either $\Phi^+$ or $\Phi^-$ depending on whether $\omega $ is $\varpi_k$ or $-\varpi_k$.
 From~\cref{lem:bruhat} and the normality of the subgroup $\St(\Phi, A[X], X[A]) \leq G^+$ we obtain that
  \[G^+ = \UU(\Phi^{+}', A)\cdot \St(\Phi, A[X], XA[X]) \cdot \StW(\Phi,A)\cdot \overline{\St}(\Phi, A, M) \cdot\UU(\Phi^+, A).\]
 The first two factors in the above decomposition are contained in $N_\omega$, so the assertion follows from the definition of $\star$.
\end{proof}


For $\lambda \in \Lambda$ and a commutative ring $R$ we denote by $\Stab_{\lambda}(R)$ the subgroup of $\G_{sc}(\Phi, R)$
 consisting of elements stabilizing the basis vector $v^\lambda$ of $V$.
%Recall that the projection $\pi \colon \St(\Phi, R) \to \G_{sc}(\Phi, R)$ is always injective on unipotent subgroups.
Moreover, it is clear that $ev_{X=0}^*(N_\lambda) = \pi^{-1}(\Stab_\lambda(A))$ and that
 $(\Stab_{\varpi_k}(A))^{w_{\lambda, u}} = \Stab_\lambda(A)$.
\begin{lemma} \label{lem:q}
Suppose that $a \in \UU(\Phi^+, A)$ is such that its image $\pi(\overline{a})$ lies in $\Stab_{\lambda}(A/M)$ for some $\lambda \in \Lambda$.
Then there exists $q \in \UU(\Phi^+, M)$ such that $\pi(aq)$ lies in $\Stab_{\lambda}(A)$.
\end{lemma}
\begin{proof}
    Set $b = {}^{w_{\lambda, u}} a$.
    Notice that $b \cdot v_+ = v^+ + \sum_{\mu < \varpi_k} c_\mu v^\mu = 1$, therefore by the Chevalley--Matsumoto decomposition~\cite[Theorem~1.3]{St78} we can write
     $b = b_1 \cdot b_2$ for some $b_1$ such that $\pi(b_1) \in \Stab_{\varpi_k}(A)$ and $b_2 \in \UU(\Sigma_k^-, A)$.
    It is also clear from our assumptions that $c_\mu \in M$ hence $b_2 = \prod_{\alpha \in \Sigma_k^-}x_{\alpha}(c_{\varpi_k + \alpha})$, in fact, belongs to $\UU(\Sigma_k^-, M)$.
    Set $a_i = b_i^{w_{\lambda, u}}$.
    It is clear that $a = a_1 \cdot a_2$  for some $a_1, a_2$ satisfying $\pi(a_1) \in \Stab_\lambda(A)$, $\pi(a_2) \in \UU(\Phi^+ \cap \overline{w_{\lambda, u}^{-1}}(\Sigma_k^-), M)$,
     from which the assertion of the lemma follows.
\end{proof}

\begin{prop} \label{prop:v-correctness2}
 For every $w \in W$, $v \in V_\omega$ such that $v' = w \star v \in V_\omega$ there exists $w' \in W$ such that
  $\delta_\omega(w \star v) = w' \star \delta_\omega(v)$.
\end{prop}
\begin{proof}
 It suffices to consider the case $\omega = \varpi_k$.
 Suppose that $v = (x_1 x_2, y, z) = (a, b, 1) \star v'$, where $v' = (x_1' x_2', y', z')$.
 We have that
 \begin{equation}\label{eq:x-xprime} x_1 x_2 = x_1' x_2' \cdot \mu(b) \cdot a  \text{ for some }x_1, x_1' \in N_\omega,\ x_2, x_2' \in \StW(\Phi, A) \end{equation}
 and some $a \in \UU(\Phi^+, A[X]),\ b \in \St(\Phi, A[X], M[X])$.
 Thanks to~\cref{lem:can-repr} we may assume, without loss of generality, that $x_2 = w_{\lambda, u}$, $x_2' = w_{\lambda', u'}$
 for some $u, u' \in A^\times$, $\lambda, \lambda' \in \Lambda$.

 Evaluating both sides of~\eqref{eq:x-xprime} at $X=0$ and projecting the equality into $\St(\Phi, \kappa)$ we obtain the equality
 \begin{equation} \label{eq:sides}
 \overline{{x_2'}^{-1}} \cdot \overline{{x_1'}^{-1}(0)} \overline{x_1(0)} \cdot \overline{x_2} = \overline{a(0)}.
 \end{equation}

 Notice that the middle factor in the left-hand side of~\eqref{eq:sides} stabilizes the highest-weight vector $v^+$,
 therefore we can compute the images of the vector $v^{\lambda'}$ under both sides of~\eqref{eq:sides} using~\eqref{eq:w-highestweight} as follows:
 \begin{align} \overline{{x_2'}^{-1}} \cdot \overline{{x_1'}^{-1}(0)} \overline{x_1(0)} \cdot \overline{x_2} \cdot v^{\lambda'} = \overline{{x_2'}^{-1}} \cdot \overline{{u}^{-1}} \cdot v^+ &= \overline{u^{-1}}\overline{u'} \cdot v^\lambda, \\
               \overline{a(0)} \cdot v^{\lambda'} &= v^{\lambda'} + \sum_{\mu > \lambda'} \overline{a_\mu} v^\mu \label{eq:right-side} \end{align}
 for some $a_\mu \in A$.
 Thus, from~\eqref{eq:sides}--\eqref{eq:right-side} we conclude that $\lambda = \lambda'$ and that $1 - u/u' \in M$ and also that $a_\mu \in M$.
 Using~\cite[Lemma~7]{V00} and~\eqref{eq:w-highestweight} we can find $\alpha \in \Sigma_k^-$ (if $\lambda \neq \varpi_k$) or $\alpha \in \Sigma^+_k$ (if $\lambda = \varpi_k$)
  and $m \in M$ such that the element $x_2' \cdot h_\alpha(1+m) \cdot x_2^{-1}$ stabilizes the highest weight vector $v^+$.
 By the same argument as in the proof of~\cref{lem:can-repr} we obtain that it belongs to $\StW(\Delta_k, A)$.
 Consequently, we can write $x_2 = c \cdot x_2' \cdot h_\alpha(1+m)$ for some $c \in \StW(\Delta_k, A)$.


 Also we conclude from all the equalities obtained up to this point that
 \begin{equation} {}^{x_2'}(a \cdot \mu(b^a) \cdot h_\alpha^{-1}(1+m)) = {x_1'}^{-1} \cdot x_1 \cdot c \in N_\omega. \end{equation}
 Since by~\cref{lem:delta-weyl} $N_{\overline{w} \cdot \omega} = {}^w{N_\omega}$ we conclude that
  $a \cdot \mu(b^a) \cdot h_\alpha^{-1}(1+m) \in {N_{\lambda}}$.

 From~\eqref{eq:right-side} and~\cref{lem:q} we also obtain $q \in \UU(\Phi^+, M)$ such that $\pi(a(0) \cdot q) \in \Stab_\lambda(A)$ and hence
     that $a \cdot q \in N_\lambda$.
 Now we can compute the first coordinate of $\delta_\omega \cdot v$ using the fact that $\overline{w_{\lambda, u}^{-1}}(\omega) = \lambda$ as follows:
 \begin{multline*}
  \sigma(\omega)(x_1) \cdot x_2 = \sigma(\omega)(x_1'x_2' \cdot \mu(b) \cdot a \cdot x_2^{-1}) \cdot x_2 = \\
   = \sigma(\omega)(x_1'x_2' \cdot \mu(b) \cdot a \cdot h^{-1}_\alpha(1+m) \cdot {x_2'}^{-1} \cdot c^{-1}) \cdot c \cdot x_2' \cdot h_{\alpha}(1+m) = \\
   = \sigma(\omega)\left(x_1'\cdot {}^{x_2'} (aq \cdot q^{-1} \mu(b^a) \cdot h^{-1}_\alpha(1+m))\right) \cdot x_2' \cdot h_{\alpha}(1+m) = \\
   = \sigma(\omega)(x_1') \cdot {}^{x_2'}\sigma(\lambda)(aq) \cdot {}^{x_2'}\sigma(\lambda)(q^{-1} \mu(b^a) \cdot h^{-1}_\alpha(1+m)) \cdot x_2' \cdot h_{\alpha}(1+m) = \\
   = \sigma(\omega)(x_1') \cdot x_2' \cdot \sigma(\lambda)(aq) \cdot \sigma(\lambda)(q^{-1} \mu(b^a) \cdot h^{-1}_\alpha(1+m)) \cdot h_{\alpha}(1+m).
 \end{multline*}

 Now we let us compute the second coordinate of $\delta_\omega \cdot v$ using \eqref{eq:chi-h} and the fact that
 $\chi_{\omega, X}$ acts identically on $\StW(\Delta_k, A)$.
 \begin{multline*}
 x_2^{-1}\cdot \chi_{X, \omega}(x_2 \cdot y) = x_2^{-1}\chi_{\omega, X}(x_2 \cdot a^{-1} \cdot y') = \\
 = h_{\alpha}^{-1}(1 + m) \cdot {x_2'}^{-1} \cdot c^{-1} \cdot \chi_{\omega, X}(c \cdot x_2' \cdot h_{\alpha}(1 + m) \cdot a^{-1} \cdot y') = \\
 = {x_2'}^{-1} \cdot h_{\alpha}^{-1}(1 + m) \cdot \chi_{\omega, X}(h_{\alpha}(1 + m) \cdot x_2' \cdot a^{-1} \cdot y') = \{X, 1+m\} \cdot {x_2'}^{-1} \chi_{\omega, X}(x_2' a^{-1} y').
 \end{multline*}

    \textbf{to be continued}

 \end{proof}

For $\omega = \om \varpi_k$ the function $\delta_\omega \colon V_{\omega} \to V_{-\omega}$ gives rise to a well-defined function $\overline{\delta}_\omega \colon V/\sim_W \to V/\sim_W.$
Indeed, by~\cref{lem:v-correctness1} for every $v \in V$ there exists $w \in W$ such that $w \star v \in V_\omega$, therefore
we can define $\overline{\delta_\omega}(v)$ as the equivalence class of $\delta_{\omega}(w \star v)$.
By~\cref{prop:v-correctness2} this definition is correct, i.\,e. does not depend on the choice of $w$.

\begin{prop}
    There is a well-defined action of $\St(\Phi, A[X, X\inv])$ on $V/\sim_W$ compatible with the action of $\St(\Phi, A[X])$.
\end{prop}
\begin{proof}
    Thanks to~\cref{prop:rel-poly-Laurent} it suffices to construct the action of the group $G$ on $V/\sim_W$.
    Here $V$ denotes the free product of $\langle \sigma \rangle$ and $\St(\Phi, A[X])$ amalgamated over the relations~\eqref{eq:sigma-sigma-plus}--\eqref{eq:sigma-delta}.

    We let the generator $\sigma$ of $G$ act on $V/\sim_W$ via $\delta_{\varpi_k}$.
    For $\alpha \in \Phi$ we define the translation action of $g \in \St(\Phi, A[X])$ on $V$ via $g \cdot (x, y, z) \coloneqq (gx, y, z)$.
    It is easy to see that this definition is correct and gives rise to a well-defined action of $\St(\Phi, A[X])$ on $V/\sim_W$.

    Thus, it remains to check that these two actions satisfy the relations~\eqref{eq:sigma-sigma-plus}--\eqref{eq:sigma-delta}.
    We will only verify this for~\eqref{eq:sigma-sigma-plus}, the argument for other relations is similar.
    Indeed, for $v = (x_1 \cdot x_2, y, z) \in V_{-\omega_k}$, where $x_1 \in V_{-\varpi_k}$, $x_2 \in \StW(\Phi, A)$, $y \in B$, $z \in G_M$ and $\alpha_k \in \Sigma_k^+$, $f \in A[X]$
     we obtain from~\eqref{eq:sigmadef} and~\eqref{eq:sigma-def} that
    \begin{multline*}
        \overline{\delta}_{\varpi_k} \cdot x_\alpha(f) \cdot \overline{\delta}_{-\varpi_k} \cdot [x_1 \cdot x_2, y, z] = \\
        = \overline{\delta}_{\varpi_k} \cdot x_\alpha(f) \cdot [\sigma(-\varpi_k)(x_1) \cdot x_2, x_2^{-1} \cdot \chi_{-\varpi_k, X}(x_2 \cdot y), \widetilde{\chi}_{-\varpi_k, X}(z)] = \\
        = \left[\sigma(\varpi_k)\left(x_{\alpha}(f) \cdot \sigma(-\varpi_k)(x_1)) \cdot x_2, x_2^{-1} \cdot \chi_{\varpi_k, X}\left(x_2 \cdot x_2^{-1} \cdot \chi_{-\varpi_k, X}(x_2 \cdot y)\right), z\right] = \\
        = [x_\alpha(Xf) \cdot x_1 \cdot x_2, y, z] = x_\alpha(Xf) \cdot [x_1 \cdot x_2, y, z]. \qedhere
    \end{multline*}
\end{proof}

\begin{lemma} \label{lem:family1}
    For $z \in \St(\Phi, M[X, X\inv], A[X, X\inv])$, $n, m \geq 0$, $f \in M[X]$, $g \in A[X]$, $\beta \in \Sigma_k^-$ one has
    \[ z_\beta(X^{-m}f, X^{-n}g) \cdot [1, 1, z] =  [1, 1, z_\beta(X^{-m}f, X^{-n}g) \cdot z].\]
\end{lemma}
\begin{proof}
    Notice that in the group $G$ one has
    \begin{equation} z_\beta(X^{-m}f, X^{-n}g) =
     \sigma^n \cdot x_{-\beta}(-g) \cdot \sigma^{-n-m} \cdot x_{\beta}(f) \cdot \sigma^{n + m} \cdot x_{-\beta}(g) \cdot \sigma^{-n} \end{equation}
    For shortness we write $[x, y, z] \rightsquigarrow_{g} [x', y', z']$ to illustrate the fact
     $[x', y', z'] = g \cdot [x, y, z]$.
    It is easy to see from~\eqref{eq:sigmadef} and~\eqref{eq:sigma-def} that
    \begin{multline*}
    [1, 1, z] \rightsquigarrow_{\overline{\delta}_{-\varpi_k}^n}
    [1, 1, \widetilde{\chi}^n_{-\varpi_k, X}(z)] \rightsquigarrow_{x_{-\beta}(g)}
    [x_{-\beta}(g), 1, \widetilde{\chi}_{-\varpi_k, X}^n(z)] = \\
    = [1, x_{-\beta}(g), \widetilde{\chi}^n_{-\varpi_k, X}(z)] \rightsquigarrow_{\overline{\delta}_{\varpi_k}^{n + m}}
    [1, x_{-\beta}(X^{-n-m}g), \widetilde{\chi}^m_{\varpi_k, X}(z)] \rightsquigarrow_{ x_{\beta}(f) } \\
    \rightsquigarrow_{ x_{\beta}(f) } [x_{\beta}(f), x_{-\beta}(X^{-n-m}g), \widetilde{\chi}^m_{\varpi_k, X}(z)] = \\
    = [1, x_{-\beta}(X^{-n-m}g), x_{\beta}(f)^{x_{-\beta}(X^{-n-m}g)} \widetilde{\chi}^m_{\varpi_k, X}(z)] \rightsquigarrow_{\overline{\delta}^{n + m}_{-\varpi_k}} \\
    \rightsquigarrow_{\delta_{-\varpi_k}^{n + m}} [1, x_{-\beta}(g), x_{\beta}(X^{-n-m}f)^{x_{-\beta}(g)} \widetilde{\chi}^n_{-\varpi_k, X}(z)] \rightsquigarrow_{ x_{-\beta}(-g) } \\
    \rightsquigarrow_{ x_{-\beta}(-g) } [1, 1, x_{\beta}(X^{-n-m}f)^{x_{-\beta}(g)} \widetilde{\chi}^n_{-\varpi_k, X}(z)] \rightsquigarrow_{ \overline{\delta}_{\varpi_k}^n }
    [1, 1, x_{\beta}(X^{-m}f)^{x_{-\beta}(X^{-n}g)} \cdot z],
    \end{multline*}
    from which the assertion of the lemma follows.
\end{proof}

\begin{lemma} \label{lem:family2}
    For $z \in \St(\Phi, M[X, X\inv], A[X, X\inv])$, $\alpha \in \Delta_k$, $n \geq 0$ and $f \in M[X]$ one has
    \begin{equation*} x_\alpha(X^{-n} f) \cdot [1, 1, z] = [1, 1, x_\alpha(X^{-n} f) \cdot z]. \end{equation*}
\end{lemma}
\begin{proof}
    We can find $\beta \in \Sigma_k^+$ such that $\alpha + \beta \in \Phi$ or $\langle \alpha, \beta \rangle = -1$.
    Notice that by~\eqref{eq:chi-w} one has $\chi_{\omega, X}^n(w_\beta(1)) = w_\beta(X^{n\langle \omega, \beta \rangle})$, therefore
    ${}^{w_\beta(X^n)} x_{s_\beta(\alpha)}(f) = x_\alpha(\eta X^{-n} f)$
    for $\eta = \eta(\beta, s_\beta(\alpha)) = \pm 1$.
    Consequently, ${}^{\sigma^n \cdot w_\beta(1) \sigma^{-n}} x_{s_\beta(\alpha)}(f) = x_\alpha(\eta X^{-n} f)$.

    Notice also that from~\eqref{eq:w-computation} it follows that
     \[ w_\beta(u) \cdot \chi_{\omega, X}(w^{-1}_\beta(u)) = \{ X^{-\langle \omega, \beta \rangle }, u \} \cdot h_\beta(X^{-\langle \omega, \beta \rangle}). \]

    Consequently, a direct computation involving~\eqref{eq:sigmadef}, \eqref{eq:sigma-def} and~\cite[Lemme~5.1--5.2]{Ma69} shows that there exists an element $c \in \StH(\Phi, A[X, X\inv])$
     (in fact, a product of Steinberg symbols) such that
    \begin{multline*}
        [1, 1, z] \rightsquigarrow_{\delta_{-\varpi_k}^n}
        [1, 1, \widetilde{\chi}_{-\varpi_k}^n(z)] \rightsquigarrow_{w^{-1}_\beta(1)}
        [w_\beta^{-1}(1), 1, \widetilde{\chi}_{-\varpi_k}^n(z)] \rightsquigarrow_{\delta_{\varpi_k}^n} \\
        \rightsquigarrow_{\delta_{\varpi_k}^n} [w_\beta^{-1}(1), c \cdot h_\beta^n(X^{-1}), z] \rightsquigarrow_{x_{s_\beta(\alpha)}(f)}
        [x_{s_\beta(\alpha)}(f) \cdot w_\beta^{-1}(1), c \cdot h_\beta^n(X^{-1}), z] = \\
        = [w_\beta^{-1}(1) \cdot x_{\alpha}(\eta f), c \cdot h_\beta^n(X^{-1}), z] =
          [w_\beta^{-1}(1), c \cdot h_\beta^n(X^{-1}), x_{\alpha}(\eta f)^{h_\beta^n(X^{-1})} \cdot z] = \\
        = [w_\beta^{-1}(1), c \cdot h_\beta^n(X^{-1}), x_{\alpha}(\eta fX^{-n}) \cdot z] \rightsquigarrow_{\delta_{-\varpi_k}^n}
          [w_\beta^{-1}(1), 1, \widetilde{\chi}_{-\varpi_k, X}^n (x_{\alpha}(\eta fX^{-n}) \cdot z)] \rightsquigarrow_{ w_\beta(1) } \\
        \rightsquigarrow_{ w_\beta(1) } [1, 1, \widetilde{\chi}_{-\varpi_k, X}^n (x_{\alpha}(\eta fX^{-n}) \cdot z)] \rightsquigarrow_{\delta_{\varpi_k}^n}
          [1, 1, x_{\alpha}(\eta fX^{-n}) \cdot z] \qedhere
    \end{multline*}
\end{proof}

Now we are ready to prove the main result of this section.
\begin{proof}{Proof of~\cref{thm:horrocks-k2}}
    Thanks to~\cref{lem:first-reduction} and~\cref{lem:second-reduction} it suffices to show that the action of
    $\St(\Phi, A[X, X\inv])$ on $V/\sim_W$ constructed above satisfies property
    $\mu(h) \cdot [1, 1, z] = [1, 1, hz]$ for $h, z \in \St(\Phi, A[X, X\inv], M[X, X\inv])$.
    It suffices to verify this property for $h$ belonging to a generating set of $\St(\Phi, A[X, X\inv], M[X, X\inv])$.
    According to~\cref{lem:relative-generators} it suffices to verify this assertion for
    $z_{\beta}(f, g)$, $f \in M[X, X\inv]$, $g \in A[X, X\inv]$, $\beta \in \Sigma_k^-$ and
    $x_\alpha(f)$, $f \in M[X, X\inv]$, $\alpha \in \Phi$.
    But this assertion is contained~\cref{lem:family1}, the assertion symmetric to~\cref{lem:family1} (which is left as an exercise) and~\cref{lem:family2}.
\end{proof}


