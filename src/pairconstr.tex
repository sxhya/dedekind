Throughout this section $\Phi$ denotes a root system of type $\rD_{\geq 5}$, $\rE_6$ or $\rE_7$ and
 $k$ has the same meaning as in~\cref{subsec:short-presentation}, namely
 it denotes the index of the simple root $\alpha_k$ corresponding to the vertex marked green on the Dynkin diagram from Figure 1.
The aim of this section is to prove the existence of a $\varpi_k^\vee$-pair in the sense of~\cref{dfn:delta-pair}.
Throughout this section we also assume the ground ring $A$ to be local.

First of all, recall that the ideal $XA[X]$ is a splitting ideal of $A[X]$, therefore
 $\St(\Phi, A[X])$ decomposes as $\St(\Phi, A[X], XA[X]) \rtimes \St(\Phi, A)$.
Notice also that under our assumptions on $\Phi$ and $k$, the weight $\varpi_k^\vee$ is a microweight, so the subgroup $N_{\varpi_k^\vee}$ contains $\St(\Phi, A[X], XA[X])$.
In fact, $N_{\varpi_k^\vee}$ decomposes into the semidirect product of $N_0 := \St(\Phi, A[X], XA[X])$ and the parabolic subgroup $P_k \leq \St(\Phi, A)$
 generated by $x_\alpha(a)$, $a \in A$ for all $\alpha \in \Delta \sqcup \Sigma^+_k$.

Recall that the universal property of semidirect products gives for any group $H$ acting on a group $N$
 and any group homomorphisms $f_N\colon N \to G$, $f_H\colon H \to G$ satisfying
\begin{equation}
    \label{eq:coherence-condition} f_N({}^hn) = {}^{f_H(h)} f_N(n),\ n\in N,\ h\in H
\end{equation}
a unique map $f\colon N \rtimes H \to G$ extending $f_N$ and $f_H$.

Applying this universal property to our situation we reduce the problem of constructing $\sigma(\varpi_k^\vee) \colon N_{\varpi_k^\vee} \to N_{-\varpi_k^\vee}$
 to the construction problem for $\sigma(\varpi_k^\vee)_{P_k}$ and $\sigma(\varpi_k^\vee)_{N_0}$.
Since $P_k = L_k \ltimes U_k$, where $L_k = \mathrm{Im}(\St(\Delta_k, A) \to \St(\Phi, A))$
and $U_k = \UU(\Sigma_k^+, A)$ we may apply the universal property once again and further reduce the construction problem for $\sigma(\varpi_k^\vee)_{P_k}$
 to the corresponding problems for $\sigma(\varpi_k^\vee)_{L_k}$ and $\sigma(\varpi_k^\vee)_{U_k}$.
The latter two homomorphisms now can be defined directly as follows:
\[\sigma(\varpi_k^\vee)_{L_k} \coloneqq \mathrm{id}_{L_k},\ \sigma(\varpi_k^\vee)\left(\prod\limits_{\alpha \in \Sigma_k^+} x_\alpha(a_\alpha)\right) \coloneqq \prod\limits_{\alpha \in \Sigma_k^+} x_\alpha(Xa_\alpha).\]

Thus, it remains to construct $\sigma({\varpi_k^\vee})_{N_0}$.
We will use~\cref{thm:relPres} to reduce this problem to the special case $\Phi = \rA_3$.
In our situation \cref{thm:relPres} asserts that $N_0$ can be decomposed into the free product of subgroups $\St(\Psi, A[X], XA[X])$,
 where $\Psi$ ranges over the set $A_3(\Phi)$ of root subsystems of type $\rA_3$ in $\Phi$, amalgamated over embeddings of generators $z_\alpha(Xf, g)$ into different groups $\St(\Psi, A[X], XA[X])$, whose root system $\Psi \in A_3(\Phi)$ contains $\alpha$.
Thus, by the universal property of coproducts it remains to construct $\sigma(\varpi_k^\vee)_\Psi \colon \St(\Psi, A[X], XA[X]) \to N_{-\varpi_k^\vee}$ and then
  verify that these homomorphisms agree on generators $z_\alpha(Xf, g)$ of different $\St(\Psi, A[X], XA[X])$.

In the case $\Psi \subseteq \Delta_k$ the homomorphism $\sigma(\varpi_k^\vee)_\Psi$ should have identical action, so we define it as the canonical map $\St(\Psi, A[X], XA[X]) \to N_{-\varpi_k^\vee}$
induced by the embedding $\Psi \subseteq \Phi$.

Now consider the nontrivial case $\Psi \not\subseteq \Delta_k$.
It is clear that there is a unique nonzero coweight $\omega \in P(\Psi^\vee)$ determined by $(\omega, \alpha) = (\varpi_k^\vee, \alpha)$, $\alpha \in \Psi$.
By definition, the weight $\omega$ is a microweight for $\Psi^\vee$.
Suppose for a moment that we have an $\omega$-pair $\xymatrix{ \sigma(\omega)\colon N_{\omega, \Psi} \ar[r] & \ar@<-1.0ex>[l] N_{-\omega, \Psi}\colon \sigma(-\omega) }$ for the root system $\Psi\cong \rA_3$.
The required homomorphisms $\sigma(\varpi_k^\vee)_\Psi$ then can be defined as the postcomposition of $\sigma(\omega)$ with the map $N_{-\omega, \Psi} \to N_{-\varpi_k^\vee, \Phi}$ induced by the embedding $\Psi \subseteq \Phi$.

The microweights of the root system $\rA_3$ can be classfied as follows: up to an action of the Weyl group every nontrivial microweight in $\rA_3$ coincides with either $\pm\varepsilon_1$ or $\pm\varepsilon_2$ from~\cref{exm:chi-linear}.
Thus, it remains for us to construct an $\omega$-pair for the root system $\Phi=\rA_3$ in the special cases $\omega = \epsilon_1, \epsilon_2$.

We claim that the existence of $\sigma(\varepsilon_1)$-pair implies the existence of $\sigma(\varepsilon_2)$-pair.
Indeed, since $\sigma(\varepsilon_1)$ for $\varepsilon_1 = \varpi_1^\vee$ exists then so do $\sigma(\varpi_2^\vee)$ and $\sigma(-\varpi_2^\vee)$.
Now the restriction of the homomorphism $\sigma(\varepsilon_2)$ on $\St(\Psi, A[X], XA[X])$ can be defined as the composition of the restriction of $\sigma(\varpi_1^\vee)$ on $\St(\Psi, A[X], XA[X])$ and $\sigma(-\varpi_2^\vee)$.
It easy to check that these homomorphisms can be composed correctly and that the image is contained in $N_{-\varepsilon_2, \Psi}$.
To define $\sigma(\varepsilon_2)$ on the whole group $N_{\varepsilon_2, \Psi}$ it remains to use the same trick with semidirect products.

Thus, we are left to prove the existence of $\sigma(\varepsilon_1)$-pair for the root system $\Psi$ of type $\rA_3$.
Applying the semidirect product trick once again we further reduce the problem to the question of existence of the restriction of $\sigma(\varepsilon_1)_{N_0}$ where $N_0 = \St(4, A[X], XA[X])$.

Denote by $d_1$ the matrix $d_1(X) = \mathrm{diag}(X, 1, \ldots, 1) \in \GL(4, A[X, X\inv])$.
Now for $u \in \E(4, A[X])$ and $v \in (XA[X])^n$ we can define the map $(\sigma_1)_{N_0}$ on the generators of $N_{0}$
using the elements defined in~\cref{subsec:another-presentation}:
\begin{equation*}
(\sigma(\varepsilon_1))_{N_0} (F(u, v)) = X^{d_1 \cdot X^{-1}}(u, v),\ (\sigma_1)_{N_0} (S(v, u)) = Y^{d_1}(v, u).
\end{equation*}
It is clear that the above elements belong to $N_{-\varepsilon_1}$.

\begin{prop}
    If $A$ is a local ring them the map $(\sigma_1)_{N_0}$ preserves relations~\eqref{add4}--\eqref{coef-move}.
    In particular, the map $(\sigma_1)_{N_0}$ is well-defined.
\end{prop}
\begin{proof}
    For~\eqref{add4}--\eqref{add5} this is an immediate corollary of~\cref{itm:xsmall-additivity} and \cref{lem:xy-wd}.
    By~\cref{lem:xy-conj} for $g \in N_{-\varepsilon_1}$ one has
    \begin{equation}
        \label{eq:xy-conj-n1}
        g \cdot X^{d_1 X^{-1}}(u', v') \cdot g^{-1} = X^{d_1 X^{-1}}(mu', m^*v'), \text{ where } m = d_1 \cdot \pi(g) \cdot d_1^{-1}.
    \end{equation}
    To obtain that $(\sigma(\varepsilon_1))_{N_0}$ preserves~\eqref{conj3} it remains to set $g = X^{d_1 X^{-1}}(u, v)$.

    Let us verify that $\sigma(\varepsilon_1)$ preserves~\eqref{coef-move}, i.\,e. that for $a\in XA[X]$ and $m \in \E(4, A[X])$ one has
    $X^{d_1 X^{-1}}(me_1, m^*e_2 a) = Y^{d_1}(me_1 a, m^* e_2)$.
    First, let us verify this in the special case when $m^* \in \E(4, A[t])$ belongs to the subset $G_0 = H_{12}(A) \cdot U^+_1(A) \cdot U^-_1(A)$
    (here $H_{12}(A)$ denotes the subgroup of $T(4, A)$ generated by semisimple root elements $h_{12}(\xi)$, $\xi \in A^\times$).
    It is easy to check that in this case the only nonzero components of $v = m^* e_2$ are $v_1$ and $v_2$.
    Write $u = m e_1$ as the sum $u' + u''$, where $u' = (u_1, u_2, 0, \ldots 0)^t,$ $u'' = (0, 0, u_3, \ldots u_n)^t$.
    Since $u^t v = 0$ we obtain that $u', u'' \in D(v)$.
    Now from Lemmas~\ref{lem:xy-wd}--\ref{lem:xy-conj} we conclude that:
    \begin{multline}
        \label{eq:special-case}
        Y^{d_1}(me_{1}a, m^* e_2) = x(d_1^{-1} \cdot u'a, d_1\cdot  v) \cdot x(d_1^{-1}\cdot u''a, \delta_1 \cdot v) = \\
        = x(d_1^{-1} ua, d_1 \cdot v) = x(\delta_1^{-1}X \cdot u, d_{1}X^{-1} \cdot v a) = X^{\delta_1 X^{-1}}(me_1, m^*e_2 a).
    \end{multline}

    To obtain the assertion in the general case notice that for local $A$ the group $\E(4, A)$ admits the following decomposition:
    \[\E(4, A) = \mathrm{EP}_1(A) \cdot H_{12}(A) \cdot U^-_1(A) \cdot U^+_1(A).\]
    This can be either obtained as a corollary of Gauss decomposition or can be proved by a direct calculation. %TODO: Give reference

    Applying transpose-inverse automorphism $(-)^*$ to the above decomposition and invoking~\cref{lem:n1-decomp} we obtain that $\E(4, A[X]) = \phi(N_1) \cdot G_0$.
    Thus, every $m \in \E(4, A[X])$ can be factored as $\pi(n) \cdot h$ for some $n\in N_(\varepsilon_1)$ and $h \in G_0$.
    Since $\pi(n) = \delta_1 \pi(n') \delta_1^{-1}$ for some $n' \in N(-\varepsilon_1)$ it remains to apply~\eqref{eq:xy-conj-n1} and~\eqref{eq:special-case}:
    \begin{multline}
        \nonumber X^{d_1 X^{-1}}(me_1, m^*e_{2}a) = {}^{n'}(X^{d_1 X^{-1}}(he_1, h^*e_{2}a)) = \\
        = {}^{n'}(Y^{d_1}(he_{1}a, h^*e_2)) = Y^{d_1}(me_{1}a, m^{*} e_{2}).
    \end{multline}
\end{proof}

Thus, we have completed the construction of the map $(\sigma_1)_{N_{\varepsilon_1}}$.
It is not hard to verify that the condition~\eqref{eq:coherence-condition} is satisfied with these definitions,
therefore, we have also completed the construction of the map $\sigma_1$.